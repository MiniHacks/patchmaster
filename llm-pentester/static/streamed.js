
// iife
(() => {
    var api;
    htmx.defineExtension("streamed", {
        init: function(apiRef) {
            api = apiRef;
        },
        onEvent: function(name, evt) {
            console.log(name, evt)
            switch (name.trim()) {
                case "htmx:beforeRequest":
                    api.getInternalData(evt.target).xhrRequest = evt.detail.xhr;
                    break;
                case "htmx:xhr:progress":
                    let xhr = api.getInternalData(evt.target).xhrRequest 
                    document.getElementById("logs").innerHTML = xhr.responseText;
                    break;
            }
        }  
    });
})()